# 전송 계층 

## 포트 
- 전송 계층은 네트워크 계층의 한계를 극복하고 응용 계층과의 연결 다리 역할을 한다. 

### 포트의 정의 
- 네트워크 외부에서 전송받기 위한 파일을 구성하는 패킷들이 라우팅이 되어 수신인의 PC에 도착했다지만 수신인의 컴퓨터에 웹 브라우저, 게임, 메신저 프로그램을 실행하고 있으며 여기서 끝이 아니다. 
- 패킷들은 웹브라우저로 전송 되어야 할 수도 있고 게임, 메신저 프로그램에 전달되어야 할 수도 있다.
- 패킷은 실행 중인 특정 애플리케이션 프로세스 까지 전달 되어야 한다. 
- 결국 패킷의 최송 수신 대상은 특정 애플리케이션 프로세스 이다. 
- 어떤 패킷을 수신할 애플리케이션에 대한 정보가 패킷에 없다면 해당 패킷은 어떤 애플리케이션에 전달해야 할지 알수 없다. 
- 패킷이 실행 중인 특정 애플리케이션까지 전달될려면 패킷에 특정 애플리케이션을 식별할 수 있는 정보가 포함되어야 하는데 이러한 정보를 포트라고 한다. 
  
### 포트의 분류 
- 전송 계층에서는 포트 번호를 통해서 애플리케이션을 식별한다. 
- 패킷 내 수신지 포트와 송신지 포트를 통해 호스트의 애플리케이션을 식별한다. 
- 전송 계층의 프로토콜인 TCP, UDP는 모두 송수신지의 포트 번호를 포함한다. 
- 포트 번호는 16비트로 사용가능한 포트의 수는 2^16개 이다. 
- 할당 가능한 포트는 0~65535번 까지이다. 
  
#### 잘알려진 포트 (well known portㄴ)
- 0부터 1024번 까지의 포트 번호는 잘 알려진 포트이다. 

| 포트 번호 | 프로토콜 | 서비스 이름           | 설명                              |
|-----------|----------|------------------------|-----------------------------------|
| 20        | TCP      | FTP (Data)             | 파일 전송 프로토콜 (데이터)       |
| 21        | TCP      | FTP (Control)          | 파일 전송 프로토콜 (제어)         |
| 22        | TCP      | SSH                    | 보안 셸 (원격 로그인)             |
| 23        | TCP      | Telnet                 | 원격 터미널 접속 (보안 취약)     |
| 25        | TCP      | SMTP                   | 이메일 전송                        |
| 53        | TCP/UDP  | DNS                    | 도메인 이름 시스템                 |
| 67        | UDP      | DHCP (Server)          | IP 주소 자동 할당 (서버 쪽)       |
| 68        | UDP      | DHCP (Client)          | IP 주소 자동 할당 (클라이언트 쪽) |
| 80        | TCP      | HTTP                   | 웹 서비스 (비암호화)              |
| 110       | TCP      | POP3                   | 이메일 수신                        |
| 123       | UDP      | NTP                    | 시간 동기화                        |
| 143       | TCP      | IMAP                   | 이메일 수신 (서버에 저장 유지)    |
| 161       | UDP      | SNMP                   | 네트워크 관리 프로토콜            |
| 194       | TCP      | IRC                    | 인터넷 릴레이 채팅                |
| 443       | TCP      | HTTPS                  | 보안 웹 서비스 (SSL/TLS)          |
| 465       | TCP      | SMTPS                  | 보안 이메일 전송 (SSL)            |
| 993       | TCP      | IMAPS                  | 보안 이메일 수신 (IMAP + SSL)     |
| 995       | TCP      | POP3S                  | 보안 이메일 수신 (POP3 + SSL)     |
| 8080      | TCP      | HTTP (Alternative)     | HTTP 대체 포트                    |
| 8443      | TCP      | HTTPS (Alternative)    | HTTPS 대체 포트                   |

#### 등록된 포트(registered port)
- 1024~49151 까지는 등록된 포트이다. 

#### 동적, 사설, 임시 포트  
- 49152 ~ 65535에 해당한다. 
- 인터넷 할당 번호 관리 기관에 의해 할당된 애플리케이션 프로토콜이 없고 자유롭게 사용 가능하다. 
- 서버로 동작하는 프로그램의 포트번호는 사전에 암묵적으로 정해져 있지만 클라이언트로서 동작하는 프로그램은 동적 포트 번호 중 임의의 번호가 할당 된다.
- IP 주소와 포트 번호에 대한 정보가 주어지면 특정 호스트에서 실행 중인 특정 애플리케이션 프로세스를 식별할 수 있따. 
  
### 포트 기반 NAT 
- NAT란 IP주소를 변환하는 기술이며 주로 네트워크 내부에서 사용되는 사설 IP주소와 네트워크 외부에서 사용되는 공인 IP 주소를 변환하는데 이러한 변환을 위해 사용되는 것이 NAT 테이블이다. 
  
#### NAT 변환 테이블 
- NAT 변환 테이블은 변환의 대상이 되는 주소 쌍이 명시되어 있다. 
  
#### NAPT 
- 포트기반 NAT를 NAPT 라고 한다. 
- NAPT는 포트를 활용해 하나의 공인 IP주소를 여러 사설 IP 주소가 공유할 수 있도록 하는 NAT의 일종이다. 
  
### 포트포워딩 
- 네트워크 내 특정 호스트에 IP 주소와 포트를 미리 할당하고 해당 IP주소 포트로 호스트에게 패킷을 전달한다. 
- 네트워크 내부에 여러 호스트가 공인 IP를 공유한다. 네트워크 외부에서 통신을 할려고 할때 네트워크 외부의 호스트가 네트워크 내부의 특정 호스트에세 패킷을 송신하고 싶어도 네트워크 내에서는 사설 IP를 사용하고 있고 여러 호스트가 하나의 공인 IP를 공유하고 있다. 
- 특정 IP 주소와 포트번호 쌍을 할당 한다. 특정 호스트에게 할당한 뒤 외부에서 통신을 할 호스트에게 해당 접속 정보를 알려주면 된다.
--- 
> 강민철, 『혼자 공부하는 네트워크』, 한빛미디어 (2018)    


