#  응용계층 
## HTTP Header 
### 요청시 활용되는 헤더  
#### Host 
- Host 는 요청을 보낼 호스트를 나타내는 헤더이다. 주로 도메인 네임을 명시되며 포트번호가 포할 될 수 있다.
### User-Agent 
- User-Agent 는 Host와 더불어 HTTP요청 메시지에서 가장 많이 볼 수 있다. 
- User-Agent 는 웹 브라우저와 같이 HTTP 요청을 시작하는 클라이언트 측의 프로그램을 의미한다. 
- 요청 메시지 생성에 관여한 클라이언트 프로그램과 관련된 다양한 정보가 명시된다. 

#### Referer 
- 클라이언트가 요청을 보낼 때 머무르고 있던 URL이 명시된다. 

#### Authorization 
- Authorization는 클라이언트의 인증 정보를 담는 헤더이다. 
- 이 헤더에는 인증 타입과 인증을 위한 정보가 차례로 명시된다. 

### 응답시 활용되는 헤더 
#### Server
- Server 헤더는 요청을 처리하는 서버측의 소프트웨어와 관련된 정보를 명시한다.  
#### Allow 
- 클라이언트에게 허용된 HTTP 메서드 목록을 알려주기 위해 사용된다. 
#### Retry-After 
- 자원을 사용할 수 있는 날짜 혹은 시간을 나타낸다.

        HTTP/1.1 503 Service Unavailable
        Retry-After: 30 // 30초 


        HTTP/1.1 429 Too Many Requests
        Retry-After: Sun, 20 Jul 2025 07:15:00 GMT
        Content-Type: application/json
#### Location 
- 클라이언트에게 자원의 위치를 알려주기 위해 사용되는 헤더로 리다이렉션 발생, 새로운 자원 생성시 사용된다. 

#### WWW-Authenticate 
- 상태 코드 401과 함께 사용되는 헤더이다. 
- WWW-Authenticate헤더는 자원에 접근하기 위한 인증 방식을 설명하는 헤더이다. 


### 응답과 요청 모두에서 활용되는 헤더 
#### Date 
- 메시자가 생성된 날짜와 시각에 관련된 정보를 담은 헤더이다. 
- 클라이언트와 서버 모두에게 사용되는 헤더이다. 


#### Connection
- Connection 헤더는 클라이언트의 요청과 응답 간의 연결 방식을 설정하는 헤더이다. 
- Connection 필드에는 다양한 값이 명시될 수 있지만 keep-alive, close 가 대표적으로 사용된다. 

#### Content-Type, Content-Language, Content-Encoding 
- 이 헤더들은 전송하려는 메시지의 본문의 표현 방식을 설명하는 헤더로 표현 헤더라고 부르기도 한다. 

        Content-Type: text/html; charset=UTF-8
        Content-Language : ko_KR
        Content-Encoding : gZip 

- Content-Language 헤더는 메시지 본문에 사용된 자연어를 명시한다. 
- Content-Encoding 헤더는 메시지 본문을 압축하거나 변환한 방식이 명시된다. 

### 캐시 
- 불필요한 대역폭 낭비와 응답 지연을 방지하기 위해서 정보의 사본을 임시로 저장하는 기술이다. 
- 캐시는 웹브라우저에 저장되어 있기도 하고 클라이언트와 서버 사이에 위치한 중간 서버에 저장되기도 한다. 
- 전자를 개인 전용 캐시(Private Cache) 후자를 공용 캐시(Public Cache)라고 한다. 
- 캐시는 원본 데이터의 사본을 임시로 저장하는 기술이기 때문에 캐시 했다면 항상 캐시한 이후에 원본 데이터가 변경되는 상황에 대비해야 한다. 
- 캐시된 사본 데이터가 얼마나 최신 원본 데이터와 유사한지를 계산한지는 <u>캐시 신선도(cache freshness)</u> 라고 표현한다. 
- 캐시 신선도를 유지하는 가장 기본적인 방법은 캐시된 데이터에 유효기간을 설정하는 방법이다. 
- 캐시할 데이터에 유효기간을 부여하는 방법으로 응답 메시지의 Expires 헤더 와 Cache-Control 헤더에 Max-Age 를 사용할 수 있다. 

        HTTP/1.1 200 OK
        Content-Type: application/json
        Cache-Control: max-age=60
        Content-length : 100
        Last-Modified: Mon, 21 Jul 2025 06:00:00 GMT

        HTTP/1.1 200 OK
        Content-Type: application/json
        Expires: Wed, 23 Jul 2025 00:00:00 GMT

- 클라이언트가 응답받은 자원을 캐시해서 이용하다가 캐시의 유효 기간이 만료되었을 경우에 서버에게 다시 요청한다. 
- 클라이언트는 캐시된 자원이 유효한지 여전히 최신 상태의 정보인지 검사해야 하는데 하나는 날짜를 기반으로 물어보거나, 엔티티태그를 기반으로 물어보는 방법이 있다. 

#### 날짜 기반 
- 클라이언트는 If-modified-Since 헤더를 통해서 서버에게 특정 시점 이후로 원본데이터 변경이 있는지 물어볼 수 있다. 
- 요청받은 자원이 변경되었다면 200(OK)와 함께 새로운 자원을 반환한다. 
- 변경이 되지 않았다면 304(Not Modified)를 통해 자원이 변경되지 않았음을 알린다. 
- 요청받은 자원이 삭제되었다면 404(Not Found)를 통해 요청한 자원이 존재하지 않음을 알린다. 

#### 엔티티 태그 
- Etag는 자원의 버전을 식별하기 위한 정보이며 버전이란 유의미한 변경 사항을 의미한다. 
- 자원이 변경될 때 마다 버전을 식별하는 Etag값이 변경된다.이때 사용하는 헤더가 If-None-Match 이다. 

### 쿠키 
- HTTP는 기본적으로 상태를 유지하지 않는 스테이트리스 프로토콜이다. 
- HTTP 쿠키란 서버에서 생성되어 클라이언트에 저장되는 데이터로 상태를 유지하지 않는 HTTP의 특성을 보완하기 위한 수단이다. 
- 서버가 클라이언트의 상태를 알 수 있게끔 하는 특별한 데이터다. 
- 쿠키를 이루는 정보는 기본적으로 <키, 값> 쌍의 형태를 띠고 있고 추가로 적용 범위와 만료기간 등 다양한 속성을 가질 수 있다.
- 쿠키는 서버가 생성하고 클라이언트는 서버로 부터 받은 쿠키를 활용한다. 응답 메시지의 Set-Cookie, 요청메시지의 Cookie 헤더를 통해 전달한다. 

        Set-Cookie : 이름 = 값 
        Set-Cookie : 이름 = 값 속성 1 
        Set-Cookie : 이름 = 값 속성1; 속성2 
- 쿠키의 대표적인 한계는 바로 보안이다. 쿠키 정보가 쉽게 노출되거나 조작될 수 있기 때문이다. 
- 이를 보완하기 위한 속성으로 Secure와 HttpOnly라는 속성이 있다. 

### 콘텐츠 협상 
- 콘텐츠 협상이란 같은 URI에 대해 가장 적합한 자원의 형태를 제공하는 메커니즘을 의미한다. 
- 같은 URI로 식별한 HTML문서라고 해도 영어로 요청하면 영어로 된 형태를 제공하고 한국어로 요청하면 한국어로 된 형태를 제공한다. 


--- 
> 강민철, 『혼자 공부하는 네트워크』, 한빛미디어 (2018)    


