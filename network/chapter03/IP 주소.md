# 네트워크 계층 
## IP주소 
- 하나의 IP 주소는 네트워크 주소와 호스트 주소로 구성된다. 
- 전자는 호스트가 속한 특정 네트워크를 식별하는 기능을 하고, 후자는 네트워크 내에서 특정 호스트를 식별하는 기능을 한다.  

### 네트워크 주소와 호스트 주소 
- 네트워크 주소는 네트워크 ID, 네트워크 식별자 등으로 부르기도 하고 호스트 주소는 호스트 ID, 호스트 식별자로 부르기도 한다. 
- IP 주소가 172.16.12.45 라고 할 때 네트워크 주소는 172.16이고 호스트 주소 12.45이다.  
- 네트워크 주소가 하나의 옥텟으로 이루어져 있다면 한 네트워크당 호스트 주소 할당에 24비트를 할당할 수 있어서 많은 호스트에 IP를 할당할 수 있다. 
- 네트워크 주소가 세개의 옥텟으로 이루어져 있다면 네트워크당 호스트 주소 할당에 8 비트를 사용할 수 있어서 적은 호스트에 IP를 할당할 수 있다. 
- 호스트 주소 공간을 크게 할당 하면 호스트가 할당되지 않은 IP가 낭비되고 호스트 주소 공간을 작게 할당하면 호스트가 사용할 IP 주소가 부족할 수 있다. 
- 위의 고민을 해결하기 위해 생겨난 개념이 IP 주소의 클래스이다. 

### 클래스풀 주소 체계(classful addressing) 
- 클래스는 네트워크 크기에 따라 IP 주소를 분류하는 기준으로 클래스를 이용하면 호스트 IP 개수에 따라 네트워크 크기를 가변적으로 조정해서 네트워크 주소와 호스트 주소를 구획할 수 있다. 
- 클래스를 기반으로 IP 주소를 관리하는 체계를 **클래스 풀 주소 체계** 라고 한다. 
- A, B, C, D, E  총 다섯개의 클래스가 있지만  이 중 D, E는 각각 멀티캐스트를 위한 클래스, 특수 목적을 위한 클래스이기 때문에 네트워크 크기를 나누는데는 A, B, C가 사용된다.  

#### A 클래스 
- A클래스는 B, C 클래스에 비해 할당 가능한 호스트 주소가 많다. 
- 네트워크 주소는 1 옥텟 호스트 주소는 3 옥텟으로 구성된다. 
- 2^7개의 A 클래스 네트워크가 존재할 수 있고 2^24개의 호스트 주소를 가질 수 있다. 
- A 클래스 IP 주소의 최소값과 최대값은 0.0.0.0 ~ 127.255.255.255이다. 

#### B 클래스 
- B 클래스는 2^14개의 B 클래스 네트워크와 2^16개의 호스트 주소를 가질 수 있다. 
- B 클래스는 최소값과 최대값은 128.0.0.0 ~ 191.255.255.255 이다. 

#### C클래스 
- C 클래스는 2^21개의 C 클래스 네트워크와 2^8개의 호스트 주소를 가질 수 있다. 
- C 클래스는 최소값과 최대값은 192.0.0.0 ~ 223.255.255.255 이다.   
- 호스트의 모든 주소 공간을 사용할 수 있는 것이 아니며 호스트 주소가 전부 0인 IP 주소와 전부 1인 IP 주소는 특정 호스트를 지칭하는 IP주소로 활용할 수 없다. 
- 전자는 해당 네트워크 자체를 의미하고 후자는 브로드캐스트를 위한 주소로 사용되기 때문이다. 
  
| 클래스 | 시작 비트 (초기 비트) | 첫 옥텟 범위 | 네트워크 수| 호스트 수/네트워크 |
|--------|------------------------|--------------|------------------------|------------------------------|
| A      | 0xxxxxxx               | 0 ~ 127      | 2⁷ = 128               | 2²⁴ - 2 = 16,777,214         |
| B      | 10xxxxxx               | 128 ~ 191    | 2¹⁴ = 16,384           | 2¹⁶ - 2 = 65,534             |
| C      | 110xxxxx               | 192 ~ 223    | 2²¹ = 2,097,152        | 2⁸ - 2 = 254                 |


### 클래스리스 주소 체계(classless addressing) 
- 클래스풀 주소체계는 클래스별 네트워크 크기가 고정되어 있기 때문에 여전히 다수의 IP 주소가 낭비될 수 있다. 
- 300명의 직원이 사용할 컴퓨터들을 동일한 네트워크에 구성하고 싶을때 클래스풀 주소 체계에서는 어쩔 수 없이 B 클래스를 이용해야 한다. 
- 이러한 문제를 해결하기 위해서 클래스풀 주소 체계보다 더 유동적이고 정교하게 네트워크를 구획할 수 있는 클래스리스 주소체계(classless addressing)가 등장했다. 
- 클래스의 개념 없이 클래스에 구애 받지 않고 네트워크 영역을 나누어서 호스트에세 IP 주소 공간을 할당하는 방식이다. 
  
#### 서브넷 마스크 
- 클래스풀은 클래스를 이용해 네트워크 주소와 호스트 주소를 구분한다.
- 클래스리스 주소 체계는 클래스를 이용하지 않으므로 IP주소 상에서 네트워크 주소와 호스트 주소를 구분 짓는 지점은 임의의 지점이 될 수 있다. 
- 클래스리스 주소 체계에서는 네트워크와 호스트를 구분 짓는 수단으로 서브넷 마스크를 이용한다. 
- 서브넷 마스크는 IP 주소 상에서 네트워크 주소를 1 호스트 주소를 0으로 표기한 비트열을 의미한다. 
- 네트워크 내의 부분적인 네트워크를 구분 짓는 마스크 비트열이다. 서브넷 마스크를 이용해 클래스를 원하는 크기로 더 잘 쪼게 사용하는 것을 서브네팅이라고 한다. 
- A 클래스 255.0.0.0
- B 클래스 255.255.0.0 
- C 클래스 255.255.255.0 
  
#### 서브네팅 비트 AND 연산 
- 서브넷 마스크를 이용해 네트워크 주소와 호스트 주소를 구분 짓는 방법은 단순하다. IP주소와 서브넷 마스크를 비트 AND 연산을 하면 된다. 
- 192.168.219.103 = 11000000.10101000.11011011.01100111
- 255.255.255.0   = 11111111.11111111.11111111.00000000 
- 네트워즈 주소    = 11000000.10101000.11011011.00000000 
- 사용된 서브넷 마스크에서 0이 8이므로 호스트 주소는 8비트로 표현가능하다. 
  
#### 서브넷 마스크 표기 : CIDR 표기법 
- 255.255.255.0, 255.255.255.252 처럼 10진수로 직접 표기 가능 
- IP주소/서브넷 마스크상의 1의 개수 형식으로 표기하는 방법을 CIDR 표기법이라고 한다. 
  
### 공인 IP 주소와 사설 IP 주소 
#### 공인 IP 주소 
- 전 세계에서 고유한 IP주소이다. 공인 IP 주소는 ISP나 공인 IP 주소 할당 기관을 통해서 받을 수 있다. 

#### 사설 IP 주소 
- 사설 IP 주소는 사설 네트워크에서 사용하기 위한 주소이다. 인터넷, 외부 네트워크에 공개되지 않은 네트워크를 의미한다. 
- 사설 IP 주소의 할당 주체는 라우터이다. 할당 받은 사설 IP주소는 해당 호스트가 속한 사설 네트워크상에서만 유효한 주소이다. 

#### NAT(Network Address Translation)
- 사설 IP주소를 사용하는 호스트가 외부 네트워크와 통신하기 위해서 사용되는 기술이 바로 NAT이다. 
- NAT는 IP주소를 변환하는 기술로 주로 네트워크 내부에서 사용되는 사설 IP주소와 네트워크 외부에서 사용되는 공인 IP 주소를 변환하는데 사용된다. 

### 정적 IP 주소와 동적 IP 주소 
#### 정적 할당 
- 정적 할당은 호스트에 직접 수작업으로 IP주소를 부영하는 방식이다. 이를 Static IP Address라고 한다. 

#### 동적할당과 DHCP 
- IP주소를 정적으로만 할당하면 호스트의 수가 많아질 경우 관리가 곤란해진다. 
- 잘못된 입력, 중복 입력과 같은 상황이 발생하는데 이런 상황에 사용하는 것이 동적 할당 방식이다. 이렇게 할당된 IP 주소를 Dynamic IP Address 라고 한다. 
- 동적 할당에 사용되는 대표적인 프로토콜이 바로 DHCP(Dynamic Host Configuration Protocol)이다. 

### 전 세계의 IP 주소 할당 
- 라우터는 인터넷 번호 할당 기관 (IANA:Internat Assigned Numbers Authority)가 관리하는 고유한 IPv4, IPv6 주소 중에서 사용하는 주소를 가져오게 된다. 
- IANA는 대륙별로 인터넷 레지스트리를 저장하고 IP 주소 범위를 할당 하는데 대륙별 인터넷 레지스트리를 RIR(Regional Internet Registry) 라고 한다. 
- RIR 에서는 다시 LIR(Local Internet Registry) 라고 불리는 지역별 인터넷 레지스트리에 IP 범위를 할당한다. 
- LIR에서 다시 하위 업체에게 할당하거나 자체적으로 공급자 역할(ISP:Internet Service Provider) 을 맡아서 IP를 할당해 준다.
 
--- 
> 강민철, 『혼자 공부하는 네트워크』, 한빛미디어 (2018)    
> 아티클 19, 『읽자마자 IT 전문가가 되는 네트워크 교과서』, 보누스(2023)
